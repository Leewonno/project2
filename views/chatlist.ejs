<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>채팅방 목록</title>
    <style>
      .joinchat{
        display: flex;
        justify-content: flex-start;
        flex-wrap: wrap;
      }

  
    
      #s{
        display: flex;
        justify-content: space-evenly;
        margin-top: 10%;
      }
      .recommand{
        display: flex;
        justify-content: space-evenly;
        margin-top: 10%;
      }
      .talk_section img{
        width: 160px; 
        height: 160px;
        border-radius: 50%;
        border: 1px solid;
        
      }
      .my_talk img{
        position: absolute
      }
      .talk_section .imgdiv{
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 160px;
        height: 160px;
        transition: all 0.3s;
      }
      .talk_section .imgdiv:hover{
        transform:scale(1.2);
      }
      .imgdiv:hover p{
        display: flex;
      }

      .category_talk .imgdiv, .recommand .imgdiv{
        width: 100px;
        height: 100px;
      }

      .category_talk img, .recommand img{
        width: 100%;
        height: 100%;
      } 
      .talk_section p{
        text-align: center;
      }
      .my_talk div{
        margin-left: 5px;
    
        margin-right: 5px;
        margin-bottom: 10px;
      }

      .imgdiv p{
        position: absolute;
        display: none;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: 100%;
        border-radius: 50%;
        background-color: rgb(0,0,0,0.6);
        color: white;
      }


      
    </style>
  </head>
  <body>
    <%- contentFor('body') %>
    <section class="talk_section">
      <div class="talk_list">
        <div class="column_first">
          <div class="my_talk">참여중인톡방
            <div class="joinchat">
              <% if (!joinChat){%>
                <span>로그인이 필요합니다.</span>
              <%}else{%>
                <% for(let i = 0; i<joinChat.length; i++){%>
                  <div class = "imgdiv" onclick="talk('<%=joinChat[i].name %>')">
                    <img src="<%=joinChat[i].cover_img%>" alt="">
                    <p><%=joinChat[i].name%></p>
                  </div>
                <%}%>
              <%}%>
            </div>
          </div>
        </div>
        <div class="column_second">
          <div class="category_talk">주제별 톡방
            
            <button value="girlgroup" id="gG" onclick="select_tag(`girlgroup`)">girlgroup</button>
            <button value="boygroup" id="bG" onclick="select_tag(`boygroup`)">boygroup</button>
            <button value="Wsolo" id="wS" onclick="select_tag(`Wsolo`)">Female Solo</button>
            <button value="Msolo" id="mS" onclick="select_tag(`Msolo`)">Male Solo</button>
            
            <div id = "s" >
              <% for(let i = 0; i<tag.length; i++){%>
                <div class = "imgdiv"  onclick="talk('<%=tag[i].name %>')">
                  <img class ="tagimage"src="<%=tag[i].cover_img%>" alt="">
                  
                  <p><%=tag[i].name%><br>접속자 수: <%=tag[i].member %></a>
                </div>
              <%}%>
            </div>
          </div>
          <div class="recommand_talk">톡방 추천
            <div class="recommand">

              <% for(let i = 0; i<best.length; i++){%>
                <div class = "imgdiv"  onclick="talk('<%=best[i].name %>')">
                  <img src="<%=best[i].cover_img%>" alt="">
                  <p><%=best[i].name%></p>
                  <p>접속자 수: <%=best[i].member %></p>
                </div>
              <%}%>
            </div>
            </div>
        </div>
    </section>


    <%- contentFor('player') %>
   
    <script id="sc">
      

      function talk(roomname) {
          window.open(`/chat?room=${roomname}`, 'Child', 'width=400, height=500, top=50, left=50');
        }

      function select_tag(tagName){    
        axios({
          method: 'POST',
          url: '/chat/list',
          data:{
            tag: tagName
          }
        }).then((res) => {
          const chat_tag = res.data.tag;
          console.log("ass",chat_tag)
          document.querySelector("#s").innerHTML = ""

          for(let i =0; i<chat_tag.length;i++){
            let cg = document.createElement('div')
            cg.setAttribute("onclick", `talk('${chat_tag[i].name}')`)
            
            cg.innerHTML = `<img src="${chat_tag[i].cover_img}" >
                  <p>${chat_tag[i].name}</p>
                  <p>접속자 수: ${chat_tag[i].member} </p>`;
            document.querySelector("#s").appendChild(cg)
          }
        });
      }


    </script>


   
</body>
</html>

